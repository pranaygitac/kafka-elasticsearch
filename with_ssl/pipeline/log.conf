input {
  beats {
    port => 5045
    ssl => true
    #ssl_certificate_authorities => ["/usr/share/logstash/cert/logstash.crt"]
    ssl_certificate => "/usr/share/logstash/cert/logstash.crt"
    ssl_key => "/usr/share/logstash/cert/logstash.key"
    #ssl_verify_mode => "force_peer"
  }
}

filter {
    # mutate {
    #     add_field => { "logstash.hostname" => "%{[container][name]}" }
    # }
     mutate {
        add_field => { "logstash.hostname" => "${LOGSTASH_HOST_NAME}" }
    }
    mutate {
        convert => { "logstash.hostname" => "string" }
     }   
}

output {
  # stdout {
  #       codec => rubydebug
  #   }
  elasticsearch {
        hosts => ['http://10.51.96.67:9200']
        user => 'elastic'
        password => 'pranay'
        #template_name => "backup_app_indextemp"
        #ilm_enabled => true
        #index => "backup"
        ilm_rollover_alias => "logstash_filebeat_logs"
        ilm_pattern => "{now/d}-000001"
        ilm_policy => "backup_app_ILM"
    }
  }
